# Реализация страницы "Взаиморасчеты (клиенты)"

## Обзор
Реализована новая страница "Взаиморасчеты (клиенты)" для отдельного отображения долговых операций с клиентами. Это улучшает ясность и правильность учета финансовых операций.

## Архитектура

### 1. Разделение данных
- **Страница "Транзакции"**: показывает только обычные транзакции (is_debt=false)
- **Страница "Взаиморасчеты"**: показывает только долговые операции (is_debt=true)

### 2. API эндпоинт
Используется один эндпоинт `/transactions` с параметром `is_debt`:
- `is_debt=false` - обычные транзакции
- `is_debt=true` - долговые операции

## Изменённые файлы

### Фронтенд

#### 1. Новая страница `MutualSettlementsPage.vue`
- Путь: `src/views/pages/mutual_settlements/MutualSettlementsPage.vue`
- Фильтры: по клиенту и датам
- Колонки:
  - `id`: номер транзакции
  - `debtType`: тип операции (Продажа (долг) / Оплата клиента)
  - `clientName`: имя клиента
  - `clientImpact`: влияние на задолженность (вычисляемое поле)
  - `note`: примечание
  - `categoryName`: категория
  - `dateUser`: дата и пользователь

#### 2. Обновленная `TransactionsPage.vue`
- Удален фильтр по долгам (`isDebtFilter`)
- Удалена колонка `debt`
- Удалена функция `handleDebtClick`
- Добавлено явное передавание `is_debt=false` при запросе данных

#### 3. Обновленная `ClientBalanceTab.vue`
- Обновлены колонки:
  - Заменена колонка `source` на `operationType` (показывает тип операции с иконкой)
  - Заменена колонка `is_debt` и `amount` на одну `clientImpact`
- Функция `label()` переработана:
  - Долги (is_debt=1): красная иконка стрелки вверх + "Продажа (долг)"
  - Оплаты (is_debt=0): зелёная иконка стрелки вниз + "Оплата клиента"
- Пересчёт `totalIncome` и `totalExpense`:
  - `totalIncome` = сумма долговых операций
  - `totalExpense` = сумма платежей (погашений долгов)

#### 4. Маршрутизация
- Добавлен маршрут: `/mutual-settlements` → `MutualSettlementsPage`
- Маршрут добавлен в основную навигацию рядом с транзакциями

#### 5. Локализация
Добавлены переводы на все языки:

**Русский (ru.js)**:
- `mutualSettlements: 'Взаиморасчеты'`
- `impact: 'По клиенту'`

**Английский (en.js)**:
- `mutualSettlements: 'Mutual Settlements'`
- `impact: 'Impact'`

**Туркменский (tm.js)**:
- `mutualSettlements: 'Aragatnaşyk hasaplaşygy'`
- `impact: 'Müşderi boýunça'`

## Логика расчёта влияния на баланс

```
client_impact = CASE WHEN is_debt=1 THEN +amount ELSE -amount END
```

- **is_debt=1 (Долг)**: показывается `+amount` красным (увеличение задолженности)
- **is_debt=0 (Оплата)**: показывается `-amount` зелёным (уменьшение задолженности)

## Пример использования

### Страница "Взаиморасчеты"
| Дата | Операция | Клиент | По клиенту | Примечание | Категория |
|------|----------|--------|-----------|-----------|-----------|
| 2024-01-15 | Продажа (долг) | ООО Компания | +5000 TMT | Товары | Продажа |
| 2024-01-18 | Оплата клиента | ООО Компания | -3000 TMT | Частичная оплата | Оплата |
| 2024-01-20 | Продажа (долг) | ООО Компания | +2000 TMT | Доставка | Продажа |

**Итого баланс**: 5000 - 3000 + 2000 = 4000 TMT (должны нам)

## Бэкенд
Не требовались изменения - логика фильтрации уже реализована в `TransactionsRepository`.
